<script>
// (cÃ³digo anterior permanece igual...)

function finalizarQuiz() {
  document.getElementById("quizBox").style.display = "none";
  document.getElementById("fimBox").style.display = "block";
  document.getElementById("userNome").innerText = nome;
  document.getElementById("acertos").innerText = respostasCertas;

  const mensagemFinal = document.getElementById("mensagemFinalTexto");
  mensagemFinal.innerHTML = respostasCertas >= 6
    ? "ðŸŽ‰ ParabÃ©ns! VocÃª demonstrou Ã³timos conhecimentos em seguranÃ§a do trabalho. Continue assim! ðŸ¦º"
    : "âš ï¸ VocÃª teve um desempenho abaixo do ideal. Que tal revisar alguns conceitos de seguranÃ§a? Isso pode fazer toda a diferenÃ§a! ðŸ’¡";

  // Envio para Google Sheets
  const dados = {
    nome: nome,
    setor: setor,
    funcao: funcao,
    acertos: respostasCertas,
    erros: 8 - respostasCertas
  };

  fetch("https://script.google.com/macros/s/AKfycbxlrgXJh0BZDcC3b9meg5ixw2sMlzrzeOx_TdMBw8bE9ZN-7Icuw3coyw6o_NoY1rYC/exec", {
    method: "POST",
    body: JSON.stringify(dados),
    headers: {
      "Content-Type": "application/json"
    }
  }).then(response => response.text())
    .then(res => {
      console.log("Enviado com sucesso:", res);
    })
    .catch(err => {
      console.error("Erro ao enviar:", err);
    });

  // Link do WhatsApp
  const numeroWhatsApp = "15981214792";
  const mensagem = `OlÃ¡! Estou confirmando minha presenÃ§a na SIPAT com os seguintes dados:

ðŸ“› Nome: ${nome}
ðŸ¢ Setor: ${setor}
ðŸ‘· FunÃ§Ã£o: ${funcao}
âœ… Acertos: ${respostasCertas}
âŒ Erros: ${8 - respostasCertas}`;

  const linkWhats = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(mensagem)}`;
  document.getElementById("btnWhats").onclick = () => {
    window.open(linkWhats, "_blank");
  };
}
</script>
